define("Router",["jquery","cookie","underscore","backbone","HeaderView","HomeView","ErrorView","GameView","GameModel"],function(e,t,n,r,i,s,o,u,a){var f;return f=r.Router.extend({routes:{"":"home",home:"home","g/:id":"game"},initialize:function(){this.headerView=new i,this.currentGame=null,this.elms={"page-content":e(".page-content")}},home:function(){var t=this;this.homeView||(this.homeView=new s),this.homeView.model.on("king-start-success",function(n){console.log("Starting as king...");var r=this.get("king");e.cookie(n+".auth_king",r.authId),delete t.homeView,t.currentGame=this,t.navigate("#/g/"+this.get("code"),{trigger:!0})}),this.homeView.model.on("peasant-start-success",function(e){console.log("Starting as peasant..."),delete t.homeView,t.currentGame=this,t.navigate("#/g/"+this.get("code"),{trigger:!0})}),this.elms["page-content"].html(this.homeView.render().el)},game:function(t){var n=this,r;console.log("Code: "+t);if(!e.cookie(t+".auth_king")){if(this.currentGame){var i=this.currentGame.get("king");e.cookie(t+".auth_king",i.authId)}}else r=e.cookie(t+".auth_king");this.currentGame?(console.log("Game has been loaded...  "),this._game()):(console.log("Loading game from server..."),this.currentGame=new a({code:t,authId:r}),this.currentGame.fetch({data:{authId:r},success:function(e,t){t.error?n._errorPage(t.error):n._game()},error:function(e,t){console.log("Error")}}))},_errorPage:function(e){var t=new o;console.log("Error View: "),console.dir(e),this.elms["page-content"].html(t.render(e).el)},_game:function(){this.gameView||(this.gameView=new u(this.currentGame)),this.elms["page-content"].html(this.gameView.render().el),this.gameView.initializeAntiscroll()}}),f});