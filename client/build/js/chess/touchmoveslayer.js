define("TouchMovesLayer",["easel","tween"],function(){var e;return e=function(){this.tiles=[],this.possibles=[],this.graphics=new createjs.Container;for(var e=0;e<64;e++){var t={row:0,col:0,piece:null,graphics:null,visible:!1,setPosition:function(e,t){this.row=e,this.col=t},setVisible:function(e,t){this.visible=t,this.visible?(this.piece=e,this.glow(e)):this.fadeOut()},glow:function(){function t(){createjs.Tween.get(e.graphics,{override:!0}).to({alpha:0},3e3).call(function(){e.piece=null})}var e=this;this.graphics.alpha=.3,this.graphics.y=this.piece.row*64,this.graphics.x=this.piece.col*64,createjs.Tween.get(this.graphics,{override:!0}).to({x:this.col*64,y:this.row*64},150).call(t)},fadeOut:function(){this.piece?(createjs.Tween.get(this.graphics,{override:!0}).to({x:this.piece.col*64,y:this.piece.row*64,alpha:0},300),this.piece=null):(this.graphics.alpha=0,this.piece=null)}},n=new createjs.Graphics;n.beginFill("#0c0"),n.drawRect(0,0,64,64),n.endFill(),t.graphics=new createjs.Shape(n),t.graphics.x=e*5,t.graphics.alpha=0,this.tiles.push(t),this.graphics.addChild(t.graphics)}},e.prototype={initialize:function(){},onTouch:function(e,t){console.log("Touched!",t);var n={type:t.piece,row:t.from.row,col:t.from.col,color:t.color},r=chessLogic.exports.getPossibleMoves(e,n);console.log("PossibleMoves: "+r.length),this.setPossibleMoves(n,r)},setPossibleMoves:function(e,t){for(var n=0,r=0;n<this.tiles.length;n++){var i=this.tiles[n];if(i.piece)continue;if(t!=null&&r<t.length){var s=t[r];i.setPosition(s.to.row,s.to.col),i.setVisible(e,!0),r++}else i.setVisible(null,!1)}}},e});